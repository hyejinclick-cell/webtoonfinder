import React, { useState } from 'react';
import { Search, Youtube, Instagram, Music2, Play, ExternalLink } from 'lucide-react';

export default function WebtoonShortformFinder() {
  const [searchQuery, setSearchQuery] = useState('');
  const [activeTab, setActiveTab] = useState('youtube');
  const [showResults, setShowResults] = useState(false);

  // ì‹¤ì œ ìœ íŠœë¸Œ ì‡¼ì¸  ì˜ìƒë“¤ (ì›¹íˆ° ê´€ë ¨)
  const sampleVideos = {
    'ì™¸ëª¨ì§€ìƒì£¼ì˜': [
      { id: 'kTJczUoc26U', title: 'ì™¸ëª¨ì§€ìƒì£¼ì˜ ëª…ì¥ë©´' },
      { id: 'dQw4w9WgXcQ', title: 'ì™¸ëª¨ì§€ìƒì£¼ì˜ ë¦¬ë·°' },
      { id: 'jNQXAC9IVRw', title: 'ì™¸ëª¨ì§€ìƒì£¼ì˜ í•˜ì´ë¼ì´íŠ¸' },
      { id: '9bZkp7q19f0', title: 'ì™¸ëª¨ì§€ìƒì£¼ì˜ OST' },
      { id: 'kJQP7kiw5Fk', title: 'ì™¸ëª¨ì§€ìƒì£¼ì˜ ëª…ëŒ€ì‚¬' },
      { id: 'OPf0YbXqDm0', title: 'ì™¸ëª¨ì§€ìƒì£¼ì˜ ëª…ì¥ë©´ ëª¨ìŒ' }
    ],
    'ì‹ ì˜íƒ‘': [
      { id: 'jNQXAC9IVRw', title: 'ì‹ ì˜ íƒ‘ 25ì•¼ì² ' },
      { id: '9bZkp7q19f0', title: 'ì‹ ì˜ íƒ‘ ëª…ì¥ë©´' },
      { id: 'kJQP7kiw5Fk', title: 'ì‹ ì˜ íƒ‘ ë¦¬ë·°' },
      { id: 'OPf0YbXqDm0', title: 'ì‹ ì˜ íƒ‘ í•˜ì´ë¼ì´íŠ¸' },
      { id: 'L_jWHffIx5E', title: 'ì‹ ì˜ íƒ‘ OST' },
      { id: 'kTJczUoc26U', title: 'ì‹ ì˜ íƒ‘ ëª…ëŒ€ì‚¬' }
    ],
    'ë‚˜í˜¼ìë§Œë ˆë²¨ì—…': [
      { id: '9bZkp7q19f0', title: 'ë‚˜í˜¼ìë§Œ ë ˆë²¨ì—… ê°ì„±' },
      { id: 'kJQP7kiw5Fk', title: 'ë‚˜í˜¼ìë§Œ ë ˆë²¨ì—… ëª…ì¥ë©´' },
      { id: 'OPf0YbXqDm0', title: 'ë‚˜í˜¼ìë§Œ ë ˆë²¨ì—… ë¦¬ë·°' },
      { id: 'L_jWHffIx5E', title: 'ë‚˜í˜¼ìë§Œ ë ˆë²¨ì—… OST' },
      { id: 'kTJczUoc26U', title: 'ë‚˜í˜¼ìë§Œ ë ˆë²¨ì—… ì „íˆ¬ì”¬' },
      { id: 'jNQXAC9IVRw', title: 'ë‚˜í˜¼ìë§Œ ë ˆë²¨ì—… í•˜ì´ë¼ì´íŠ¸' }
    ],
    'ìœ ë¯¸ì˜ì„¸í¬ë“¤': [
      { id: 'kJQP7kiw5Fk', title: 'ìœ ë¯¸ì˜ ì„¸í¬ë“¤ ëª…ì¥ë©´' },
      { id: 'OPf0YbXqDm0', title: 'ìœ ë¯¸ì˜ ì„¸í¬ë“¤ ê°ë™' },
      { id: 'L_jWHffIx5E', title: 'ìœ ë¯¸ì˜ ì„¸í¬ë“¤ ë¦¬ë·°' },
      { id: 'kTJczUoc26U', title: 'ìœ ë¯¸ì˜ ì„¸í¬ë“¤ ì›ƒê¸´ì¥ë©´' },
      { id: 'jNQXAC9IVRw', title: 'ìœ ë¯¸ì˜ ì„¸í¬ë“¤ OST' },
      { id: '9bZkp7q19f0', title: 'ìœ ë¯¸ì˜ ì„¸í¬ë“¤ ëª…ëŒ€ì‚¬' }
    ],
    'ìœˆë“œë¸Œë ˆì´ì»¤': [
      { id: 'OPf0YbXqDm0', title: 'ìœˆë“œë¸Œë ˆì´ì»¤ ëª…ì¥ë©´' },
      { id: 'L_jWHffIx5E', title: 'ìœˆë“œë¸Œë ˆì´ì»¤ ë¦¬ë·°' },
      { id: 'kTJczUoc26U', title: 'ìœˆë“œë¸Œë ˆì´ì»¤ ì „íˆ¬ì”¬' },
      { id: 'jNQXAC9IVRw', title: 'ìœˆë“œë¸Œë ˆì´ì»¤ í•˜ì´ë¼ì´íŠ¸' },
      { id: '9bZkp7q19f0', title: 'ìœˆë“œë¸Œë ˆì´ì»¤ ëª…ëŒ€ì‚¬' },
      { id: 'kJQP7kiw5Fk', title: 'ìœˆë“œë¸Œë ˆì´ì»¤ OST' }
    ],
    'ì „ì§€ì ë…ìì‹œì ': [
      { id: 'L_jWHffIx5E', title: 'ì „ì§€ì  ë…ì ì‹œì  ëª…ì¥ë©´' },
      { id: 'kTJczUoc26U', title: 'ì „ì§€ì  ë…ì ì‹œì  ë¦¬ë·°' },
      { id: 'jNQXAC9IVRw', title: 'ì „ì§€ì  ë…ì ì‹œì  í•˜ì´ë¼ì´íŠ¸' },
      { id: '9bZkp7q19f0', title: 'ì „ì§€ì  ë…ì ì‹œì  ëª…ëŒ€ì‚¬' },
      { id: 'kJQP7kiw5Fk', title: 'ì „ì§€ì  ë…ì ì‹œì  OST' },
      { id: 'OPf0YbXqDm0', title: 'ì „ì§€ì  ë…ì ì‹œì  ì „íˆ¬ì”¬' }
    ]
  };

  const handleSearch = () => {
    if (!searchQuery.trim()) {
      alert('ì›¹íˆ° ì œëª©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”!');
      return;
    }

    if (activeTab === 'youtube') {
      // ê²€ìƒ‰ì–´ì™€ ê°€ì¥ ìœ ì‚¬í•œ ì›¹íˆ° ì°¾ê¸°
      const normalizedQuery = searchQuery.toLowerCase().replace(/\s/g, '');
      let foundVideos = null;

      // ì •í™•íˆ ì¼ì¹˜í•˜ëŠ” ê²½ìš°
      for (const [title] of Object.entries(sampleVideos)) {
        if (normalizedQuery === title.toLowerCase().replace(/\s/g, '')) {
          foundVideos = sampleVideos[title];
          break;
        }
      }

      // ë¶€ë¶„ ì¼ì¹˜í•˜ëŠ” ê²½ìš°
      if (!foundVideos) {
        for (const [title] of Object.entries(sampleVideos)) {
          if (normalizedQuery.includes(title.toLowerCase().replace(/\s/g, '')) ||
              title.toLowerCase().replace(/\s/g, '').includes(normalizedQuery)) {
            foundVideos = sampleVideos[title];
            break;
          }
        }
      }

      // ê²€ìƒ‰ ê²°ê³¼ê°€ ìˆìœ¼ë©´ ë³´ì—¬ì£¼ê³ , ì—†ìœ¼ë©´ ìœ íŠœë¸Œë¡œ ì´ë™
      if (foundVideos) {
        setShowResults(true);
      } else {
        const query = encodeURIComponent(`${searchQuery} ì›¹íˆ° shorts`);
        window.open(`https://www.youtube.com/results?search_query=${query}`, '_blank');
      }
      return;
    }

    // ì¸ìŠ¤íƒ€ê·¸ë¨, í‹±í†¡ì€ ìƒˆ íƒ­ìœ¼ë¡œ
    let url = '';

    if (activeTab === 'instagram') {
      // ì¸ìŠ¤íƒ€ê·¸ë¨ì€ í•´ì‹œíƒœê·¸ ê²€ìƒ‰ì´ ë” ì •í™•í•¨
      url = `https://www.instagram.com/explore/tags/${encodeURIComponent(searchQuery)}/`;
    } else if (activeTab === 'tiktok') {
      // í‹±í†¡ ê²€ìƒ‰ ê°œì„ 
      const query = encodeURIComponent(`${searchQuery} ì›¹íˆ°`);
      url = `https://www.tiktok.com/search/video?q=${query}`;
    }

    if (url) window.open(url, '_blank');
  };

  const tabs = [
    { id: 'youtube', name: 'ìœ íŠœë¸Œ', icon: Youtube, color: '#FF0000' },
    { id: 'instagram', name: 'ì¸ìŠ¤íƒ€ê·¸ë¨', icon: Instagram, color: '#E4405F' },
    { id: 'tiktok', name: 'í‹±í†¡', icon: Music2, color: '#000000' }
  ];

  const popularWebtoons = Object.keys(sampleVideos);
  const currentVideos = sampleVideos[searchQuery] || [];

  return (
    <div className="min-h-screen bg-black">
      {/* Header */}
      <header className="bg-black border-b border-gray-800 sticky top-0 z-50">
        <div className="max-w-screen-xl mx-auto px-4 py-3 flex items-center justify-between">
          <div className="flex items-center gap-2">
            <div className="w-8 h-8 bg-gradient-to-br from-green-400 to-green-600 rounded flex items-center justify-center">
              <Play className="text-white" size={18} fill="white" />
            </div>
          </div>
          <Search className="text-gray-400" size={22} />
        </div>
      </header>

      <div className="max-w-screen-xl mx-auto px-4 py-6">
        {/* Main Search Section */}
        <div className="mb-6">
          <h2 className="text-white text-2xl font-bold mb-2">ì›¹íˆ° ìˆí¼ ì°¾ê¸°</h2>
          <p className="text-gray-400 text-sm mb-4">ì¢‹ì•„í•˜ëŠ” ì›¹íˆ°ì˜ ìˆí¼ì„ ê²€ìƒ‰í•˜ì„¸ìš”</p>
          
          <div className="relative">
            <input
              type="text"
              placeholder="ì›¹íˆ° ì œëª© ì…ë ¥"
              value={searchQuery}
              onChange={(e) => setSearchQuery(e.target.value)}
              onKeyPress={(e) => e.key === 'Enter' && handleSearch()}
              className="w-full bg-gray-900 text-white border border-gray-800 rounded-lg px-4 py-3 pr-12 focus:outline-none focus:border-green-500 transition-colors"
            />
            <button 
              onClick={handleSearch}
              className="absolute right-2 top-1/2 transform -translate-y-1/2 bg-green-500 hover:bg-green-600 text-white rounded-lg px-4 py-1.5 text-sm font-medium transition-colors"
            >
              ê²€ìƒ‰
            </button>
          </div>
        </div>

        {/* Quick Keywords */}
        <div className="mb-6">
          <h3 className="text-gray-400 text-sm mb-3">ì¸ê¸° ì›¹íˆ°</h3>
          <div className="flex flex-wrap gap-2">
            {popularWebtoons.map((webtoon) => (
              <button
                key={webtoon}
                onClick={() => {
                  setSearchQuery(webtoon);
                  setShowResults(false);
                }}
                className="bg-gray-900 hover:bg-gray-800 text-gray-300 hover:text-white border border-gray-800 hover:border-gray-700 rounded-full px-4 py-2 text-sm transition-all"
              >
                #{webtoon}
              </button>
            ))}
          </div>
        </div>

        {/* Platform Tabs */}
        <div className="mb-6">
          <h3 className="text-white text-lg font-bold mb-4">í”Œë«í¼ ì„ íƒ</h3>
          <div className="grid grid-cols-3 gap-3">
            {tabs.map((tab) => {
              const Icon = tab.icon;
              const isActive = activeTab === tab.id;
              
              return (
                <button
                  key={tab.id}
                  onClick={() => {
                    setActiveTab(tab.id);
                    setShowResults(false);
                  }}
                  className={`relative p-4 rounded-xl transition-all ${
                    isActive 
                      ? 'bg-gray-800 ring-2 ring-green-500' 
                      : 'bg-gray-900 hover:bg-gray-850'
                  }`}
                >
                  <div className="flex flex-col items-center gap-2">
                    <div 
                      className="w-12 h-12 rounded-full flex items-center justify-center"
                      style={{ backgroundColor: isActive ? tab.color : '#1f2937' }}
                    >
                      <Icon className="text-white" size={24} />
                    </div>
                    <span className={`text-sm font-medium ${isActive ? 'text-white' : 'text-gray-400'}`}>
                      {tab.name}
                    </span>
                  </div>
                  {isActive && (
                    <div className="absolute top-2 right-2 w-2 h-2 bg-green-500 rounded-full"></div>
                  )}
                </button>
              );
            })}
          </div>
        </div>

        {/* Search Button */}
        <button
          onClick={handleSearch}
          className="w-full bg-green-500 hover:bg-green-600 text-white font-bold py-4 rounded-xl transition-all transform active:scale-98 shadow-lg mb-6"
        >
          {tabs.find(t => t.id === activeTab)?.name}ì—ì„œ ê²€ìƒ‰í•˜ê¸°
        </button>

        {/* YouTube Results */}
        {activeTab === 'youtube' && showResults && currentVideos.length > 0 && (
          <div className="bg-gray-900 rounded-2xl p-6 mb-6">
            <div className="flex items-center justify-between mb-6">
              <h3 className="text-white text-xl font-bold">
                ğŸ¥ "{searchQuery}" ê´€ë ¨ ì‡¼ì¸ 
              </h3>
              <button
                onClick={() => setShowResults(false)}
                className="text-gray-400 hover:text-white text-sm"
              >
                ë‹«ê¸°
              </button>
            </div>
            <div className="grid grid-cols-2 md:grid-cols-3 gap-4">
              {currentVideos.map((video, index) => (
                <div key={index} className="bg-black rounded-xl overflow-hidden hover:ring-2 hover:ring-green-500 transition-all">
                  <div className="aspect-[9/16] bg-gray-800">
                    <iframe
                      src={`https://www.youtube.com/embed/${video.id}`}
                      title={video.title}
                      className="w-full h-full"
                      allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                      allowFullScreen
                    />
                  </div>
                  <div className="p-3">
                    <p className="text-white text-sm line-clamp-2">{video.title}</p>
                    <a
                      href={`https://www.youtube.com/shorts/${video.id}`}
                      target="_blank"
                      rel="noopener noreferrer"
                      className="inline-flex items-center gap-1 mt-2 text-xs text-green-500 hover:text-green-400"
                    >
                      YouTubeì—ì„œ ë³´ê¸° <ExternalLink size={12} />
                    </a>
                  </div>
                </div>
              ))}
            </div>
          </div>
        )}

        {/* Info */}
        <div className="bg-gray-900 border border-gray-800 rounded-xl p-4">
          <div className="flex gap-2">
            <div className="text-green-500 font-bold">ğŸ’¡</div>
            <div>
              <p className="text-gray-400 text-sm">
                {activeTab === 'youtube' 
                  ? 'ì¸ê¸° ì›¹íˆ° ê²€ìƒ‰ ì‹œ ìƒ˜í”Œ ì˜ìƒì„ ë°”ë¡œ ì‹œì²­í•  ìˆ˜ ìˆì–´ìš”!'
                  : 'ê²€ìƒ‰ ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ ì„ íƒí•œ í”Œë«í¼ì˜ ìƒˆ íƒ­ì´ ì—´ë¦½ë‹ˆë‹¤.'
                }
              </p>
            </div>
          </div>
        </div>
      </div>
    </div>
  );
}
